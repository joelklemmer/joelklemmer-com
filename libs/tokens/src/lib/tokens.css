/* Authority Design Constitution — Single source of truth for palette and primitives.
   Deep Navy #0F172A, Slate Core #1E293B, Warm Neutral #F8FAFC, Steel Blue #3B82F6, Muted Cyan #0EA5A4.
   Token-driven; no decorative colors. WCAG-safe. */
:root {
  /* === Authority Design Constitution primitives (hex → HSL, space-separated for alpha) === */
  --color-deep-navy: 222 47% 11%; /* #0F172A Foundation Dark */
  --color-slate-core: 222 33% 17%; /* #1E293B */
  --color-charcoal-text: 222 39% 11%; /* #111827 */
  --color-warm-neutral: 210 40% 98%; /* #F8FAFC Foundation Light */
  --color-soft-slate: 214 32% 91%; /* #E2E8F0 */
  --color-paper-base: 0 0% 100%; /* #FFFFFF */
  --color-steel-blue: 217 91% 60%; /* #3B82F6 Structural Accent */
  --color-muted-cyan: 180 84% 35%; /* #0EA5A4 Structural Accent */
  --color-neutral-divider: 214 20% 84%; /* #CBD5E1 */

  /* Semantic surfaces (light theme) — derived from constitution light foundation */
  --color-bg: var(--color-warm-neutral);
  --color-surface: var(--color-paper-base);
  --color-surface-elevated: var(--color-warm-neutral);
  --color-surface-field: 210 33% 99%;
  --color-surface-inset: var(--color-soft-slate);
  --color-text: var(--color-charcoal-text);
  --color-muted: 222 14% 35%;
  --color-border: var(--color-neutral-divider);
  --color-border-subtle: var(--color-soft-slate);
  /* Layered neutrals — tonal hierarchy from constitution */
  --color-neutral-50: var(--color-warm-neutral);
  --color-neutral-100: var(--color-soft-slate);
  --color-neutral-200: 214 20% 84%;
  --color-neutral-300: 222 8% 68%;
  --color-neutral-400: 222 8% 50%;
  --color-neutral-500: 222 10% 35%;
  /* Structural accents — Steel Blue primary (WCAG AA on white), Muted Cyan secondary */
  --color-accent: 217 91% 52%;
  --color-accent-strong: 217 91% 45%;
  --color-accent-muted: var(--color-muted-cyan);
  --color-focus: 217 91% 52%;
  /* Semantic aliases (field, surface, inset, text primary/secondary, divider, focus ring) */
  --color-text-primary: var(--color-text);
  --color-text-secondary: var(--color-muted);
  --color-text-muted: var(--color-muted);
  --color-surface-base: var(--color-surface);
  --color-surface-tier1: var(--color-surface-elevated);
  --color-surface-1: var(--color-surface);
  --color-surface-2: var(--color-surface-elevated);
  --color-surface-primary: var(--color-surface);
  /* field, inset already defined above */

  /* Spacing scale: base 8px — 8, 16, 24, 32, 48, 64, 96, 128 (constitution) */
  --spacing-8: 0.5rem;
  --spacing-16: 1rem;
  --spacing-24: 1.5rem;
  --spacing-32: 2rem;
  --spacing-48: 3rem;
  --spacing-64: 4rem;
  --spacing-96: 6rem;
  --spacing-128: 8rem;
  --space-1: var(--spacing-8);
  --space-2: var(--spacing-16);
  --space-3: var(--spacing-24);
  --space-4: var(--spacing-32);
  --space-5: var(--spacing-48);
  --space-6: var(--spacing-64);
  --space-7: var(--spacing-96);
  --space-8: var(--spacing-128);
  --space-10: 5rem; /* 80px — layout-specific, not in scale */

  --font-sans:
    ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI',
    sans-serif;
  --font-mono:
    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono',
    'Courier New', monospace;

  /* Typography weight governance (constitution): 350, 400, 500, 600, 700, 800 */
  --font-weight-meta: 350;
  --font-weight-body: 400;
  --font-weight-label: 500;
  --font-weight-section: 600;
  --font-weight-hero: 700;
  --font-weight-hero-identity: 800;

  /* Typography system: authority hierarchy (Inter Variable when provided by app) */
  --display-heading-font: var(--font-sans);
  --display-heading-size: 2rem;
  --display-heading-line: 1.25;
  --display-heading-spacing: -0.02em;

  --section-heading-font: var(--font-sans);
  --section-heading-size: 1.5rem;
  --section-heading-line: 1.3;
  --section-heading-spacing: -0.01em;

  --body-analytical-font: var(--font-sans);
  --body-analytical-size: 1rem;
  --body-analytical-line: 1.6;
  --body-analytical-spacing: 0;

  --meta-label-font: var(--font-sans);
  --meta-label-size: 0.75rem;
  --meta-label-line: 1.4;
  --meta-label-spacing: 0.05em;

  /* Typography scale tokens (H1/H2/H3/body/small) */
  --typography-h1-size: var(--display-heading-size);
  --typography-h1-line: var(--display-heading-line);
  --typography-h1-spacing: var(--display-heading-spacing);
  --typography-h1-weight: var(--display-heading-weight);

  --typography-h2-size: var(--section-heading-size);
  --typography-h2-line: var(--section-heading-line);
  --typography-h2-spacing: var(--section-heading-letter-spacing);
  --typography-h2-weight: var(--section-heading-weight);

  --typography-h3-size: var(--text-lg);
  --typography-h3-line: var(--leading-tight);
  --typography-h3-weight: var(--font-weight-section);

  --typography-body-size: var(--body-analytical-size);
  --typography-body-line: var(--body-analytical-line);
  --typography-body-spacing: var(--body-analytical-spacing);

  --typography-small-size: var(--text-sm);
  --typography-small-line: var(--leading-normal);

  --text-xs: 0.75rem;
  --text-sm: 0.875rem;
  --text-base: 1rem;
  --text-lg: 1.125rem;
  --text-xl: 1.25rem;
  --text-2xl: 1.5rem;
  --text-3xl: 2rem;

  --leading-tight: 1.2;
  --leading-normal: 1.5;

  --container-max-width: 56rem;
  --readable-max-width: 42rem;
  --transition-duration-fast: 150ms;
  --transition-duration-normal: 200ms;
  /** Interaction micro-physics: hover/focus/press feedback — low-latency, decisive. */
  --motion-duration-feedback: 80ms;

  /* Focus ring token (high visibility, theme-aware) */
  --focus-ring-width: 2px;
  --focus-ring-offset: 2px;
  --focus-ring-color: hsl(var(--color-focus));
  --focus-ring-radius: 0.25rem;

  /* UASIL: authority signal hooks (restrained; no visible labels). */
  --authority-spacing-density: 1;
  --authority-hierarchy-emphasis: 1;
  --authority-motion-restraint: 0;
  --authority-depth-layer: 0;

  /* Depth: minimal elevation for cards and major surfaces (no decorative shadow). */
  --authority-surface-elevation: 0 1px 2px hsl(var(--color-text) / 0.04);
  --authority-surface-depth: 0 1px 3px hsl(var(--color-text) / 0.05);
  --authority-soft-glow: 0 0 0 1px hsl(var(--color-border) / 0.12);
  --authority-contrast-balance: hsl(var(--color-surface));

  /* Elevation tokens for cards/hero plates (subtle, premium) */
  --elevation-subtle: 0 1px 2px hsl(var(--color-text) / 0.03);
  --elevation-premium:
    0 2px 8px hsl(var(--color-text) / 0.05),
    0 1px 3px hsl(var(--color-text) / 0.03);

  /* ACS D) Premium material realism: glass translucency, layered depth, controlled glow, lighting realism. Subtle and restrained. */
  --authority-glass-bg: hsl(var(--color-surface) / 0.76);
  --authority-glass-border: hsl(var(--color-border) / 0.15);
  --authority-glass-blur: 14px;
  --authority-depth-layer1: 0 1px 3px hsl(var(--color-text) / 0.03);
  --authority-depth-layer2: 0 2px 8px hsl(var(--color-text) / 0.04);
  --authority-depth-layer3: 0 4px 16px hsl(var(--color-text) / 0.05);
  --authority-soft-light: 0 1px 0 0 hsl(0 0% 100% / 0.2);
  --authority-controlled-glow: 0 0 16px -4px hsl(var(--color-text) / 0.02);
  --authority-ambient-soft: radial-gradient(
    ellipse 80% 50% at 50% 0%,
    hsl(var(--color-accent) / 0.05) 0%,
    transparent 70%
  );

  /* ACS A) Atmosphere: tonal depth, ambient lighting, depth illusion. Token-controlled; WCAG-safe. */
  --authority-atmosphere-subtle: linear-gradient(
    180deg,
    hsl(var(--color-neutral-50)) 0%,
    hsl(var(--color-bg)) 22%,
    hsl(var(--color-surface)) 48%,
    hsl(var(--color-bg)) 100%
  );
  --authority-ambient-radial: radial-gradient(
    ellipse 100% 60% at 50% -20%,
    hsl(var(--color-accent) / 0.035) 0%,
    transparent 50%
  );
  --authority-depth-illusion: 0 2px 10px hsl(var(--color-text) / 0.045);
  --authority-hero-depth: 0 6px 24px hsl(var(--color-text) / 0.065);
  /* ACS B) Hero authority field: dimensional composition, atmospheric layering, visual inevitability */
  --hero-atmosphere-primary: radial-gradient(
    ellipse 85% 50% at 50% -15%,
    hsl(var(--color-neutral-100) / 0.95) 0%,
    hsl(var(--color-neutral-50) / 0.6) 35%,
    transparent 65%
  );
  --hero-atmosphere-secondary: linear-gradient(
    180deg,
    hsl(var(--color-bg) / 0.5) 0%,
    transparent 35%
  );
  --hero-atmosphere-tertiary: linear-gradient(
    180deg,
    transparent 0%,
    hsl(var(--color-surface) / 0.3) 100%
  );
  --hero-depth-shadow:
    0 6px 24px hsl(var(--color-text) / 0.06),
    0 1px 3px hsl(var(--color-text) / 0.04);
  --hero-inner-surface: hsl(var(--color-surface-elevated) / 0.94);
  --hero-inner-border: hsl(var(--color-border-subtle) / 0.2);
  --hero-inner-blur: 10px;
  --hero-typography-weight: var(--font-weight-section);

  /* VACEL B) Eye path: heading prominence, content lane, section anchoring. */
  --section-heading-margin-block-end: var(--space-3);
  --content-lane-gap: var(--space-5);
  --section-anchor-gap: var(--space-6);

  /* VACEL C) Motion: eased transitions, focus reinforcement (respects reduced-motion). */
  --ease-authority: cubic-bezier(0.25, 0.1, 0.25, 1);
  --ease-authority-out: cubic-bezier(0.33, 1, 0.68, 1);
  /** Decisive interaction: no mushy easing; crisp response. */
  --motion-ease-out: cubic-bezier(0.33, 1, 0.68, 1);

  /* Motion tokens: durations resolve under prefers-reduced-motion via override below. */
  --motion-duration-fast: var(--transition-duration-fast);
  --motion-duration-normal: var(--transition-duration-normal);
  --motion-ease: var(--ease-authority);

  /* VACEL D) Surface materiality: layered depth, refined elevation, soft translucency. */
  --authority-surface-layer2: 0 2px 8px hsl(var(--color-text) / 0.04);
  --authority-surface-translucency: 1;
  --authority-card-elevation:
    0 1px 2px hsl(var(--color-text) / 0.03),
    0 2px 4px hsl(var(--color-text) / 0.02);
  --authority-card-glow: none;

  /* VACEL E) Typography amplification: weight, hierarchy, rhythm. */
  --display-heading-weight: var(--font-weight-section);
  --section-heading-weight: var(--font-weight-section);
  --section-heading-letter-spacing: -0.02em;
  --body-rhythm-margin: var(--space-3);
  --heading-to-content-gap: var(--space-4);

  /* Section rhythm: breathing margins and vertical spacing (overridable by density). */
  --section-block-margin: var(--space-8);
  --section-inner-gap: var(--space-4);
  --section-heading-margin: var(--space-2);
  /* Section heading weight was set above with --section-heading-weight */

  /* Home page specific: tighter rhythm for briefing interface */
  --home-section-gap: var(--space-6);
  --home-section-gap-md: var(--space-7);
  --home-card-padding: var(--space-5);
  --home-card-padding-md: var(--space-6);
  --home-card-gap: var(--space-4);

  /* Spacing scale and section rhythm (vertical cadence) */
  --spacing-scale-xs: var(--space-1);
  --spacing-scale-sm: var(--space-2);
  --spacing-scale-md: var(--space-4);
  --spacing-scale-lg: var(--space-6);
  --spacing-scale-xl: var(--space-8);
  --section-rhythm: var(--section-block-margin);

  /* ACS C) Precision grid: optical alignment, cadence rhythm, hierarchy reinforcement */
  --grid-gap-base: var(--space-4);
  --grid-gap-wide: var(--space-6);
  --grid-gap-tight: var(--space-3);
  --content-rhythm: var(--space-6);
  --content-rhythm-tight: var(--space-4);
  --align-content-max: var(--container-max-width);
  --readable-line-length: var(--readable-max-width);
  --container-padding-x: var(--space-6);
  --container-padding-x-wide: var(--space-8);
  /* Optional: safe-area aware gutters (use in calc for notched devices) */
  --gutter-inline-start: calc(
    var(--container-padding-x) + env(safe-area-inset-inline-start, 0px)
  );
  --gutter-inline-end: calc(
    var(--container-padding-x) + env(safe-area-inset-inline-end, 0px)
  );
  --optical-inset: var(--space-4);
  --column-cadence: var(--space-6);
  --row-cadence: var(--space-5);

  /* ACS B) Hero: dimensional composition, typographic dominance, visual inevitability */
  --hero-display-size: clamp(2.75rem, 6vw + 1.5rem, 3.5rem);
  --hero-display-line: 1.1;
  --hero-display-spacing: -0.04em;
  --hero-display-weight: var(--font-weight-hero);
  --hero-lede-size: var(--text-lg);
  --hero-lede-line: 1.45;
  --hero-block-gap: var(--space-6);
  --hero-inline-gap: var(--space-8);
  /* ACS E) Identity gravity: photographic presence, compositional hierarchy, lighting realism */
  --hero-visual-frame: 0 0 0 1px hsl(var(--color-border) / 0.25);
  --hero-visual-depth:
    0 4px 16px hsl(var(--color-text) / 0.05),
    0 1px 4px hsl(var(--color-text) / 0.03);
  --hero-visual-glow: 0 0 0 1px hsl(var(--color-border-subtle) / 0.3);
  --hero-visual-highlight: inset 0 1px 0 0 hsl(0 0% 100% / 0.25);

  /* AIPL: Section visual anchors — token-aware composition, graphite harmony */
  --section-anchor-bg: hsl(var(--color-neutral-100));
  --section-anchor-border: hsl(var(--color-border) / 0.15);
  --section-anchor-shadow: 0 1px 3px hsl(var(--color-text) / 0.02);
  --section-anchor-radius: 0.5rem;

  /* Unified border-radius tokens */
  --radius-sm: 0.375rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-card: var(--radius-md);
  --section-anchor-min-height: 6rem;

  /* Media list: thumb derivative size only; 1:1 box; list must not load master by default. */
  --media-thumb-size: 48px;

  /* Page Frame: consistent lanes, section spacing, content stage (reduces thin-column float). WCAG-safe. */
  --page-frame-max-width: var(--container-max-width);
  --page-frame-stage-bg: hsl(var(--color-surface-elevated));
  --page-frame-stage-radius: 0.75rem;
  --page-frame-stage-elevation: 0 1px 2px hsl(var(--color-text) / 0.02);

  /* Header and Navigation: baseline alignment, spacing, active states */
  --header-padding-y: var(--space-4);
  --header-padding-y-md: var(--space-5);
  --nav-padding-y: var(--space-3);
  --nav-padding-y-md: var(--space-4);
  --nav-item-gap: var(--space-4);
  --nav-item-padding-x: var(--space-2);
  --nav-item-padding-y: var(--space-1);
  --nav-active-indicator-height: 2px;
  --header-baseline-offset: 0.125em;

  /* Masthead utility icons: single size and stroke for optical consistency */
  --masthead-icon-size: 1.25rem;
  --masthead-icon-stroke: 2;

  /* Hero CTA: letter spacing for executive clarity */
  --hero-cta-letter-spacing: 0.02em;
}

/* Motion governance: prefers-reduced-motion alters behavior — token-driven. */
@media (prefers-reduced-motion: reduce) {
  :root {
    --transition-duration-fast: 0.01ms;
    --transition-duration-normal: 0.01ms;
    --motion-duration-feedback: 0.01ms;
  }
}

@media (min-width: 640px) {
  :root {
    --media-thumb-size: 56px;
  }
}

@media (min-width: 768px) {
  :root {
    --media-thumb-size: 64px;
  }
}

/* EIL: Authority Density View — compressed scanning; tighter rhythm, emphasized hierarchy. */
[data-density='on'] {
  --authority-spacing-density: 0.75;
  --authority-hierarchy-emphasis: 1.08;
  --authority-motion-restraint: 1;
  --section-block-margin: var(--space-6);
  --section-inner-gap: calc(var(--space-4) * var(--authority-spacing-density));
}
[data-density='on'].authority-density-root {
  gap: calc(var(--space-4) * var(--authority-spacing-density));
}

/* EIL: data-dominant-signal / data-evaluator-mode — subtle hierarchy only; no color coding. */
[data-dominant-signal] {
  --authority-hierarchy-emphasis: calc(
    var(--authority-hierarchy-emphasis) * 1.02
  );
}
[data-evaluator-mode] {
  --authority-depth-layer: 1;
}

/* Deterministic light theme (Authority Design Constitution light foundation) */
:root[data-theme='light'] {
  --color-bg: var(--color-warm-neutral);
  --color-surface: var(--color-paper-base);
  --color-surface-elevated: var(--color-warm-neutral);
  --color-surface-field: 210 33% 99%;
  --color-surface-inset: var(--color-soft-slate);
  --color-text: var(--color-charcoal-text);
  --color-muted: 222 14% 35%;
  --color-border: var(--color-neutral-divider);
  --color-border-subtle: var(--color-soft-slate);
  --color-neutral-50: var(--color-warm-neutral);
  --color-neutral-100: var(--color-soft-slate);
  --color-neutral-200: 214 20% 84%;
  --color-neutral-300: 222 8% 68%;
  --color-neutral-400: 222 8% 50%;
  --color-neutral-500: 222 10% 35%;
  --color-accent: 217 91% 52%;
  --color-accent-strong: 217 91% 45%;
  --color-accent-muted: var(--color-muted-cyan);
  --color-focus: 217 91% 52%;
}

/* Fallback when no data-theme (e.g. no-JS). With theme script + provider, root always has data-theme="light"|"dark". */
@media (prefers-color-scheme: dark) {
  :root:not([data-theme='light']) {
    --color-bg: var(--color-deep-navy);
    --color-surface: var(--color-slate-core);
    --color-surface-elevated: 222 28% 20%;
    --color-surface-field: 222 26% 18%;
    --color-surface-inset: 222 30% 14%;
    --color-text: 210 40% 98%;
    --color-muted: 220 10% 68%;
    --color-border: 222 10% 22%;
    --color-border-subtle: 222 8% 18%;
    --color-neutral-50: 222 16% 12%;
    --color-neutral-100: 222 14% 16%;
    --color-neutral-200: 222 12% 20%;
    --color-neutral-300: 220 10% 42%;
    --color-neutral-400: 220 8% 56%;
    --color-neutral-500: 220 8% 68%;
    --color-accent: 217 91% 65%;
    --color-accent-strong: 217 91% 70%;
    --color-accent-muted: 180 70% 45%;
    --color-focus: 217 91% 65%;
    --authority-soft-glow: none;
    --authority-card-glow: none;
    --authority-glass-border: hsl(var(--color-border) / 0.08);
    --section-anchor-border: hsl(var(--color-border) / 0.1);
    --hero-inner-border: hsl(var(--color-border-subtle) / 0.15);
  }
}

:root[data-theme='dark'] {
  --color-bg: var(--color-deep-navy);
  --color-surface: var(--color-slate-core);
  --color-surface-elevated: 222 28% 20%;
  --color-surface-field: 222 26% 18%;
  --color-surface-inset: 222 30% 14%;
  --color-text: 210 40% 98%;
  --color-muted: 220 10% 68%;
  --color-border: 222 10% 22%;
  --color-border-subtle: 222 8% 18%;
  --color-neutral-50: 222 16% 12%;
  --color-neutral-100: 222 14% 16%;
  --color-neutral-200: 222 12% 20%;
  --color-neutral-300: 220 10% 42%;
  --color-neutral-400: 220 8% 56%;
  --color-neutral-500: 220 8% 68%;
  --color-accent: 217 91% 65%;
  --color-accent-strong: 217 91% 70%;
  --color-accent-muted: 180 70% 45%;
  --color-focus: 217 91% 65%;
  --authority-soft-glow: none;
  --authority-card-glow: none;
  --authority-glass-border: hsl(var(--color-border) / 0.08);
  --section-anchor-border: hsl(var(--color-border) / 0.1);
  --hero-inner-border: hsl(var(--color-border-subtle) / 0.15);
}

/* High contrast mode: WCAG AA+ compliance - meaningful difference, not cosmetic */
:root[data-contrast='high'] {
  --color-bg: 0 0% 100%;
  --color-surface: 0 0% 100%;
  --color-surface-elevated: 0 0% 100%;
  --color-surface-field: 0 0% 98%;
  --color-surface-inset: 0 0% 98%;
  --color-text: 0 0% 0%;
  --color-muted: 0 0% 15%;
  --color-border: 0 0% 0%;
  --color-border-subtle: 0 0% 0%;
  --color-neutral-50: 0 0% 98%;
  --color-neutral-100: 0 0% 95%;
  --color-neutral-200: 0 0% 90%;
  --color-neutral-300: 0 0% 25%;
  --color-neutral-400: 0 0% 20%;
  --color-neutral-500: 0 0% 15%;
  --color-accent: 217 100% 35%;
  --color-accent-strong: 217 100% 30%;
  --color-accent-muted: 217 100% 35%;
  --color-focus: 217 100% 40%;
  /* Strengthened focus ring for high contrast (WCAG AA+) */
  --focus-ring-width: 3px;
  --focus-ring-offset: 3px;
  --focus-ring-color: hsl(var(--color-focus));
  /* Ensure borders are visible and stronger */
  --authority-card-glow: 0 0 0 2px hsl(var(--color-border));
  --authority-soft-glow: 0 0 0 2px hsl(var(--color-border));
  /* Strengthen all borders in high contrast mode */
  --authority-surface-elevation: 0 1px 2px hsl(var(--color-border) / 1);
  --authority-surface-depth: 0 1px 3px hsl(var(--color-text) / 0.3);
}

@media (prefers-contrast: more) {
  :root:not([data-contrast]) {
    --color-bg: 0 0% 100%;
    --color-surface: 0 0% 100%;
    --color-surface-elevated: 0 0% 100%;
    --color-surface-field: 0 0% 98%;
    --color-surface-inset: 0 0% 98%;
    --color-text: 0 0% 0%;
    --color-muted: 0 0% 15%;
    --color-border: 0 0% 0%;
    --color-border-subtle: 0 0% 0%;
    --color-neutral-50: 0 0% 98%;
    --color-neutral-100: 0 0% 95%;
    --color-neutral-200: 0 0% 90%;
    --color-neutral-300: 0 0% 25%;
    --color-neutral-400: 0 0% 20%;
    --color-neutral-500: 0 0% 15%;
    --color-accent: 217 100% 35%;
    --color-accent-strong: 217 100% 30%;
    --color-accent-muted: 217 100% 35%;
    --color-focus: 217 100% 40%;
    /* Strengthened focus ring for system high contrast preference */
    --focus-ring-width: 3px;
    --focus-ring-offset: 3px;
    --focus-ring-color: hsl(var(--color-focus));
    --authority-card-glow: 0 0 0 2px hsl(var(--color-border));
    --authority-soft-glow: 0 0 0 2px hsl(var(--color-border));
    --authority-surface-elevation: 0 1px 2px hsl(var(--color-border) / 1);
    --authority-surface-depth: 0 1px 3px hsl(var(--color-text) / 0.3);
  }
}
